# SmilePicker ç”¢å“éœ€æ±‚æ–‡ä»¶ (PRD)

> **ç‰ˆæœ¬**: 1.0
> **å»ºç«‹æ—¥æœŸ**: 2026-01-22
> **ç›®æ¨™**: æ‰“é€  Chrome Web Store ä¸Šæœ€å„ªé›…çš„ç¬¦è™Ÿå¿«é€Ÿè¼¸å…¥å´é‚Šé¢æ¿æ’ä»¶

---

## ç›®éŒ„

1. [ç”¢å“é¡˜æ™¯èˆ‡ç›®æ¨™](#1-ç”¢å“é¡˜æ™¯èˆ‡ç›®æ¨™)
2. [è¦åŠƒåŠŸèƒ½](#2-è¦åŠƒåŠŸèƒ½)
3. [åŠŸèƒ½è¦åŠƒï¼ˆä¸‰éšæ®µï¼‰](#3-åŠŸèƒ½è¦åŠƒä¸‰éšæ®µ)
4. [æŠ€è¡“æ¶æ§‹è¨­è¨ˆ](#4-æŠ€è¡“æ¶æ§‹è¨­è¨ˆ)
5. [UI/UX è¨­è¨ˆè¦ç¯„](#5-uiux-è¨­è¨ˆè¦ç¯„)
6. [Chrome Web Store ä¸Šæ¶æº–å‚™](#6-chrome-web-store-ä¸Šæ¶æº–å‚™)
7. [é–‹ç™¼æ™‚ç¨‹å»ºè­°](#7-é–‹ç™¼æ™‚ç¨‹å»ºè­°)

---

## 1. ç”¢å“é¡˜æ™¯èˆ‡ç›®æ¨™

### 1.1 ç”¢å“å®šä½

**SmilePicker** å®šä½ç‚º Chrome ç€è¦½å™¨ä¸Šæœ€å„ªé›…ã€æœ€é«˜æ•ˆçš„ç¬¦è™Ÿå¿«é€Ÿè¼¸å…¥å´é‚Šé¢æ¿æ’ä»¶ã€‚

**æ ¸å¿ƒåƒ¹å€¼ä¸»å¼µ**ï¼š
- ğŸ¯ **å³æ™‚å­˜å–**: å¿«æ·éµä¸€è§¸å³é”ï¼Œå´é‚Šæ»‘å‡ºä¸æ‰“æ–·å·¥ä½œæµç¨‹
- ğŸ¨ **ç²¾ç·»é«”é©—**: ç¾ä»£åŒ– UI è¨­è¨ˆï¼Œè¦–è¦ºæ„‰æ‚…
- âš¡ **æ¥µè‡´æ•ˆç‡**: æ™ºæ…§æœå°‹ã€éµç›¤å°èˆªã€ä¸€éµè¤‡è£½
- ğŸ”„ **ç„¡ç¸«åŒæ­¥**: Chrome å¸³è™ŸåŒæ­¥æ”¶è—èˆ‡è¨­å®š

### 1.2 ç›®æ¨™ç”¨æˆ¶

| ç”¨æˆ¶é¡å‹ | æè¿° | æ ¸å¿ƒéœ€æ±‚ |
|---------|------|---------|
| **æ–‡å­—å·¥ä½œè€…** | ä½œå®¶ã€ç·¨è¼¯ã€è¨˜è€… | å¿«é€Ÿæ’å…¥æ¨™é»ã€å¼•è™Ÿã€ç‰¹æ®Šç¬¦è™Ÿ |
| **é–‹ç™¼è€…** | è»Ÿé«”å·¥ç¨‹å¸«ã€æŠ€è¡“ä½œå®¶ | æ’å…¥ç¨‹å¼ç¢¼ç¬¦è™Ÿã€ç®­é ­ã€æ•¸å­¸ç¬¦è™Ÿ |
| **è¨­è¨ˆå¸«** | UI/UX è¨­è¨ˆå¸« | å¿«é€Ÿå–ç”¨è¨­è¨ˆæ¨™æ³¨ç¬¦è™Ÿ |
| **å­¸ç”Ÿ/ç ”ç©¶è€…** | æ’°å¯«è«–æ–‡ã€å ±å‘Š | æ•¸å­¸ç¬¦è™Ÿã€å¸Œè‡˜å­—æ¯ã€å–®ä½ç¬¦è™Ÿ |
| **ç¤¾ç¾¤ç¶“ç†** | ç®¡ç†ç¤¾ç¾¤åª’é«” | è¡¨æƒ…ç¬¦è™Ÿã€è£é£¾ç¬¦è™Ÿ |

### 1.3 æˆåŠŸæŒ‡æ¨™

**Phase 1 å®Œæˆå¾Œ**:
- Chrome Web Store è©•åˆ† â‰¥ 4.5 æ˜Ÿ
- é€±æ´»èºç”¨æˆ¶ (WAU) â‰¥ 1,000

**Phase 2 å®Œæˆå¾Œ**:
- Chrome Web Store è©•åˆ† â‰¥ 4.7 æ˜Ÿ
- WAU â‰¥ 5,000
- ä»˜è²»è½‰æ›ç‡ â‰¥ 5%ï¼ˆè‹¥æ¡ç”¨ Freemium æ¨¡å¼ï¼‰

**Phase 3 å®Œæˆå¾Œ**:
- ç²å¾— Chrome Web Store ç²¾é¸æ¨è–¦
- WAU â‰¥ 20,000
- æˆç‚ºå“é¡å‰ 10 å

---

## 2. è¦åŠƒåŠŸèƒ½

### 2.1 æ ¸å¿ƒåŠŸèƒ½æ¸…å–®

| åŠŸèƒ½ | å„ªå…ˆç´š | èªªæ˜ |
|-----|--------|-----|
| Side Panel å´é‚Šé¢æ¿ | P0 | Chrome Side Panel API å¯¦ç¾ |
| å¿«æ·éµé–‹å•Ÿ | P0 | chrome.commands APIï¼ˆé è¨­ Alt+Sï¼‰ |
| ä¸€éµè¤‡è£½ç¬¦è™Ÿ | P0 | Clipboard API æ“ä½œ |
| æœ€è¿‘ä½¿ç”¨è¿½è¹¤ | P0 | æœ€å¤š 10 å€‹ï¼Œchrome.storage.local å„²å­˜ |
| æœå°‹åŠŸèƒ½ | P0 | æ”¯æ´åç¨±ã€ç¬¦è™Ÿã€é—œéµå­— |
| åˆ†é¡å±•é–‹/æ”¶åˆ | P0 | å‹•ç•«éæ¸¡ |
| ç¬¦è™Ÿæ”¶è—åŠŸèƒ½ | P1 | chrome.storage.sync åŒæ­¥ |
| è¨­å®šé é¢ | P1 | Options Page å®Œæ•´åå¥½è¨­å®š |
| ä¸»é¡Œåˆ‡æ› | P1 | æ·ºè‰²/æ·±è‰²/è·Ÿéš¨ç³»çµ± |
| è‡ªè¨‚ç¬¦è™Ÿ | P2 | ä½¿ç”¨è€…è‡ªè¡Œæ–°å¢ç¬¦è™Ÿåˆ†é¡ |

### 2.2 Chrome Extension æŠ€è¡“å°ç…§

| macOS åŸåŠŸèƒ½ | Chrome Extension å°æ‡‰ |
|-------------|----------------------|
| NSStatusItem é¸å–®åˆ—åœ–ç¤º | Extension Action Icon |
| Popover é¢æ¿ | Side Panel API |
| å…¨åŸŸå¿«æ·éµ âŒ˜â‡§S | chrome.commandsï¼ˆAlt+Sï¼‰ |
| NSPasteboard | Clipboard API |
| UserDefaults | chrome.storage.local |
| iCloud åŒæ­¥ | chrome.storage.sync |
| KeyboardShortcuts å¥—ä»¶ | chrome.commands å¯è‡ªè¨‚ |
| SwiftUI | React + TypeScript |

### 2.3 å°ˆæ¡ˆçµæ§‹è¦åŠƒ

```
smilepicker-extension/
â”œâ”€â”€ package.json
â”œâ”€â”€ vite.config.ts
â”œâ”€â”€ tailwind.config.js
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ manifest.json                    # Chrome Extension Manifest V3
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ sidepanel/                   # Side Panel ä¸»ä»‹é¢
â”‚   â”‚   â”œâ”€â”€ index.html
â”‚   â”‚   â”œâ”€â”€ index.tsx
â”‚   â”‚   â”œâ”€â”€ App.tsx
â”‚   â”‚   â””â”€â”€ components/
â”‚   â”‚       â”œâ”€â”€ SearchBar.tsx
â”‚   â”‚       â”œâ”€â”€ SymbolGrid.tsx
â”‚   â”‚       â”œâ”€â”€ CategorySection.tsx
â”‚   â”‚       â”œâ”€â”€ SymbolButton.tsx
â”‚   â”‚       â””â”€â”€ CopyFeedback.tsx
â”‚   â”‚
â”‚   â”œâ”€â”€ options/                     # è¨­å®šé é¢
â”‚   â”‚   â”œâ”€â”€ index.html
â”‚   â”‚   â”œâ”€â”€ index.tsx
â”‚   â”‚   â””â”€â”€ Options.tsx
â”‚   â”‚
â”‚   â”œâ”€â”€ background/                  # Service Worker
â”‚   â”‚   â””â”€â”€ service-worker.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ shared/
â”‚   â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â”‚   â”œâ”€â”€ useSymbols.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ useStorage.ts
â”‚   â”‚   â”‚   â””â”€â”€ useFavorites.ts
â”‚   â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”‚   â”œâ”€â”€ clipboard.ts
â”‚   â”‚   â”‚   â””â”€â”€ storage.ts
â”‚   â”‚   â”œâ”€â”€ types/
â”‚   â”‚   â”‚   â””â”€â”€ symbol.ts
â”‚   â”‚   â””â”€â”€ data/
â”‚   â”‚       â””â”€â”€ defaultSymbols.json
â”‚   â”‚
â”‚   â””â”€â”€ styles/
â”‚       â””â”€â”€ globals.css              # Tailwind å…¥å£
â”‚
â”œâ”€â”€ public/
â”‚   â””â”€â”€ icons/
â”‚       â”œâ”€â”€ icon-16.png
â”‚       â”œâ”€â”€ icon-32.png
â”‚       â”œâ”€â”€ icon-48.png
â”‚       â””â”€â”€ icon-128.png
â”‚
â””â”€â”€ dist/                            # æ‰“åŒ…è¼¸å‡º
```

---

## 3. åŠŸèƒ½è¦åŠƒï¼ˆä¸‰éšæ®µï¼‰

### 3.1 Phase 1: MVP æ ¸å¿ƒç‰ˆ

> **ç›®æ¨™**: å¯¦ç¾æ ¸å¿ƒåŠŸèƒ½ï¼Œé”åˆ° Chrome Web Store ä¸Šæ¶æ¨™æº–
> **å„ªå…ˆé †åº**: P0ï¼ˆå¿…é ˆå®Œæˆï¼‰

#### 3.1.1 Manifest V3 é…ç½®

```json
{
  "manifest_version": 3,
  "name": "SmilePicker - ç¬¦è™Ÿå¿«é¸",
  "version": "1.0.0",
  "description": "Chrome å´é‚Šé¢æ¿ç¬¦è™Ÿå¿«é€Ÿè¼¸å…¥å·¥å…·ï¼Œä¸€éµè¤‡è£½ç‰¹æ®Šç¬¦è™Ÿ",

  "permissions": [
    "sidePanel",
    "storage",
    "clipboardWrite"
  ],

  "action": {
    "default_icon": {
      "16": "icons/icon-16.png",
      "32": "icons/icon-32.png",
      "48": "icons/icon-48.png",
      "128": "icons/icon-128.png"
    },
    "default_title": "é–‹å•Ÿ SmilePicker"
  },

  "side_panel": {
    "default_path": "sidepanel/index.html"
  },

  "options_page": "options/index.html",

  "background": {
    "service_worker": "background/service-worker.js",
    "type": "module"
  },

  "commands": {
    "_execute_action": {
      "suggested_key": {
        "default": "Alt+S",
        "mac": "Alt+S"
      },
      "description": "é–‹å•Ÿç¬¦è™Ÿé¢æ¿"
    }
  },

  "icons": {
    "16": "icons/icon-16.png",
    "32": "icons/icon-32.png",
    "48": "icons/icon-48.png",
    "128": "icons/icon-128.png"
  }
}
```

#### 3.1.2 Service Worker è¨­å®š

```typescript
// background/service-worker.ts

// é»æ“Šåœ–ç¤ºæ™‚é–‹å•Ÿ Side Panel
chrome.action.onClicked.addListener(async (tab) => {
  if (tab.id) {
    await chrome.sidePanel.open({ tabId: tab.id });
  }
});

// è¨­å®š Side Panel è¡Œç‚º
chrome.sidePanel.setPanelBehavior({ openPanelOnActionClick: true });

// ç›£è½å®‰è£äº‹ä»¶ï¼Œåˆå§‹åŒ–é è¨­è³‡æ–™
chrome.runtime.onInstalled.addListener(async (details) => {
  if (details.reason === 'install') {
    // åˆå§‹åŒ–é è¨­ç¬¦è™Ÿå’Œè¨­å®š
    await chrome.storage.local.set({
      recentSymbols: [],
      settings: {
        showCopyFeedback: true,
        maxRecentSymbols: 10,
        theme: 'system'
      }
    });
  }
});
```

#### 3.1.3 ä¸»è¦ React å…ƒä»¶

**App.tsx - ä¸»æ‡‰ç”¨ç¨‹å¼**
```tsx
import { useState, useEffect } from 'react';
import { SearchBar } from './components/SearchBar';
import { SymbolGrid } from './components/SymbolGrid';
import { CategorySection } from './components/CategorySection';
import { useSymbols } from '../shared/hooks/useSymbols';
import { useStorage } from '../shared/hooks/useStorage';

export function App() {
  const [searchText, setSearchText] = useState('');
  const { categories, recentSymbols, addToRecent } = useSymbols();
  const { settings } = useStorage();

  const filteredCategories = categories.map(cat => ({
    ...cat,
    symbols: cat.symbols.filter(s =>
      s.name.toLowerCase().includes(searchText.toLowerCase()) ||
      s.symbol.includes(searchText) ||
      s.keywords?.some(k => k.toLowerCase().includes(searchText.toLowerCase()))
    )
  })).filter(cat => cat.symbols.length > 0);

  const handleCopy = async (symbol: string) => {
    await navigator.clipboard.writeText(symbol);
    await addToRecent(symbol);
  };

  return (
    <div className="h-screen flex flex-col bg-white dark:bg-gray-900">
      {/* æœå°‹åˆ— */}
      <div className="p-3 border-b border-gray-200 dark:border-gray-700">
        <SearchBar
          value={searchText}
          onChange={setSearchText}
          placeholder="æœå°‹ç¬¦è™Ÿ..."
        />
      </div>

      {/* ç¬¦è™Ÿåˆ—è¡¨ */}
      <div className="flex-1 overflow-y-auto p-3 space-y-4">
        {/* æœ€è¿‘ä½¿ç”¨ */}
        {recentSymbols.length > 0 && !searchText && (
          <CategorySection
            title="æœ€è¿‘ä½¿ç”¨"
            icon="ğŸ•"
            symbols={recentSymbols}
            onCopy={handleCopy}
            defaultExpanded
          />
        )}

        {/* åˆ†é¡ç¬¦è™Ÿ */}
        {filteredCategories.map(category => (
          <CategorySection
            key={category.id}
            title={category.name}
            icon={category.icon}
            symbols={category.symbols}
            onCopy={handleCopy}
          />
        ))}
      </div>
    </div>
  );
}
```

**SymbolButton.tsx - ç¬¦è™ŸæŒ‰éˆ•å…ƒä»¶**
```tsx
import { useState } from 'react';
import { clsx } from 'clsx';

interface SymbolButtonProps {
  symbol: string;
  name: string;
  onCopy: (symbol: string) => void;
}

export function SymbolButton({ symbol, name, onCopy }: SymbolButtonProps) {
  const [copied, setCopied] = useState(false);
  const [isHovered, setIsHovered] = useState(false);

  const handleClick = async () => {
    await onCopy(symbol);
    setCopied(true);
    setTimeout(() => setCopied(false), 1000);
  };

  return (
    <button
      onClick={handleClick}
      onMouseEnter={() => setIsHovered(true)}
      onMouseLeave={() => setIsHovered(false)}
      title={name}
      className={clsx(
        'w-10 h-10 rounded-lg text-xl',
        'flex items-center justify-center',
        'transition-all duration-150',
        'border border-transparent',
        isHovered && 'scale-105 shadow-md bg-blue-50 dark:bg-blue-900/30 border-blue-200 dark:border-blue-700',
        copied && 'bg-green-100 dark:bg-green-900/30 border-green-300',
        !isHovered && !copied && 'bg-gray-50 dark:bg-gray-800 hover:bg-gray-100 dark:hover:bg-gray-700'
      )}
    >
      {copied ? 'âœ“' : symbol}
    </button>
  );
}
```

#### 3.1.4 è³‡æ–™çµæ§‹å®šç¾©

```typescript
// shared/types/symbol.ts

export interface SymbolItem {
  symbol: string;
  name: string;
  keywords?: string[];
}

export interface SymbolCategory {
  id: string;
  name: string;
  icon: string;
  symbols: SymbolItem[];
}

export interface AppSettings {
  showCopyFeedback: boolean;
  maxRecentSymbols: number;
  theme: 'light' | 'dark' | 'system';
  symbolSize: 'small' | 'medium' | 'large';
}

export interface StorageData {
  recentSymbols: string[];
  favorites: string[];
  settings: AppSettings;
  customSymbols?: SymbolCategory[];
}
```

#### 3.1.5 é è¨­ç¬¦è™Ÿè³‡æ–™

```json
// shared/data/defaultSymbols.json
{
  "categories": [
    {
      "id": "arrows",
      "name": "ç®­é ­ç¬¦è™Ÿ",
      "icon": "â†’",
      "symbols": [
        { "symbol": "â†’", "name": "å³ç®­é ­", "keywords": ["arrow", "right"] },
        { "symbol": "â†", "name": "å·¦ç®­é ­", "keywords": ["arrow", "left"] },
        { "symbol": "â†‘", "name": "ä¸Šç®­é ­", "keywords": ["arrow", "up"] },
        { "symbol": "â†“", "name": "ä¸‹ç®­é ­", "keywords": ["arrow", "down"] },
        { "symbol": "â†”", "name": "é›™å‘ç®­é ­", "keywords": ["arrow", "both"] },
        { "symbol": "â‡’", "name": "é›™ç·šå³ç®­é ­", "keywords": ["arrow", "implies"] },
        { "symbol": "â‡", "name": "é›™ç·šå·¦ç®­é ­", "keywords": ["arrow"] },
        { "symbol": "â‡”", "name": "é›™å‘é›™ç·šç®­é ­", "keywords": ["arrow", "equivalent"] }
      ]
    },
    {
      "id": "math",
      "name": "æ•¸å­¸ç¬¦è™Ÿ",
      "icon": "âˆ‘",
      "symbols": [
        { "symbol": "Â±", "name": "æ­£è² è™Ÿ", "keywords": ["plus", "minus"] },
        { "symbol": "Ã—", "name": "ä¹˜è™Ÿ", "keywords": ["multiply", "times"] },
        { "symbol": "Ã·", "name": "é™¤è™Ÿ", "keywords": ["divide"] },
        { "symbol": "â‰ ", "name": "ä¸ç­‰æ–¼", "keywords": ["not equal"] },
        { "symbol": "â‰ˆ", "name": "ç´„ç­‰æ–¼", "keywords": ["approximately"] },
        { "symbol": "â‰¤", "name": "å°æ–¼ç­‰æ–¼", "keywords": ["less equal"] },
        { "symbol": "â‰¥", "name": "å¤§æ–¼ç­‰æ–¼", "keywords": ["greater equal"] },
        { "symbol": "âˆ", "name": "ç„¡é™å¤§", "keywords": ["infinity"] }
      ]
    },
    {
      "id": "punctuation",
      "name": "æ¨™é»ç¬¦è™Ÿ",
      "icon": "ã€Œã€",
      "symbols": [
        { "symbol": "ã€Œ", "name": "å·¦å¼•è™Ÿ", "keywords": ["quote"] },
        { "symbol": "ã€", "name": "å³å¼•è™Ÿ", "keywords": ["quote"] },
        { "symbol": "ã€", "name": "é›™å·¦å¼•è™Ÿ", "keywords": ["quote"] },
        { "symbol": "ã€", "name": "é›™å³å¼•è™Ÿ", "keywords": ["quote"] },
        { "symbol": "ã€", "name": "å·¦æ–¹æ‹¬è™Ÿ", "keywords": ["bracket"] },
        { "symbol": "ã€‘", "name": "å³æ–¹æ‹¬è™Ÿ", "keywords": ["bracket"] },
        { "symbol": "â€¦", "name": "çœç•¥è™Ÿ", "keywords": ["ellipsis"] },
        { "symbol": "â€”", "name": "ç ´æŠ˜è™Ÿ", "keywords": ["dash"] }
      ]
    },
    {
      "id": "keyboard",
      "name": "éµç›¤ç¬¦è™Ÿ",
      "icon": "âŒ˜",
      "symbols": [
        { "symbol": "âŒ˜", "name": "Command", "keywords": ["cmd", "command"] },
        { "symbol": "âŒ¥", "name": "Option", "keywords": ["alt", "option"] },
        { "symbol": "â‡§", "name": "Shift", "keywords": ["shift"] },
        { "symbol": "âŒƒ", "name": "Control", "keywords": ["ctrl", "control"] },
        { "symbol": "â‹", "name": "Escape", "keywords": ["esc", "escape"] },
        { "symbol": "â", "name": "Return", "keywords": ["enter", "return"] },
        { "symbol": "âŒ«", "name": "Delete", "keywords": ["backspace", "delete"] },
        { "symbol": "â‡¥", "name": "Tab", "keywords": ["tab"] }
      ]
    },
    {
      "id": "currency",
      "name": "è²¨å¹£ç¬¦è™Ÿ",
      "icon": "ğŸ’°",
      "symbols": [
        { "symbol": "Â¥", "name": "æ—¥åœ“/äººæ°‘å¹£", "keywords": ["yen", "yuan"] },
        { "symbol": "â‚¬", "name": "æ­å…ƒ", "keywords": ["euro"] },
        { "symbol": "Â£", "name": "è‹±éŠ", "keywords": ["pound"] },
        { "symbol": "â‚©", "name": "éŸ“åœ“", "keywords": ["won"] },
        { "symbol": "â‚¿", "name": "æ¯”ç‰¹å¹£", "keywords": ["bitcoin"] },
        { "symbol": "Â¢", "name": "ç¾åˆ†", "keywords": ["cent"] }
      ]
    },
    {
      "id": "decorative",
      "name": "è£é£¾ç¬¦è™Ÿ",
      "icon": "â˜…",
      "symbols": [
        { "symbol": "â˜…", "name": "å¯¦å¿ƒæ˜Ÿ", "keywords": ["star"] },
        { "symbol": "â˜†", "name": "ç©ºå¿ƒæ˜Ÿ", "keywords": ["star"] },
        { "symbol": "â™¥", "name": "æ„›å¿ƒ", "keywords": ["heart", "love"] },
        { "symbol": "â™¦", "name": "æ–¹å¡Š", "keywords": ["diamond"] },
        { "symbol": "â™£", "name": "æ¢…èŠ±", "keywords": ["club"] },
        { "symbol": "â™ ", "name": "é»‘æ¡ƒ", "keywords": ["spade"] },
        { "symbol": "â—", "name": "å¯¦å¿ƒåœ“", "keywords": ["circle", "bullet"] },
        { "symbol": "â—‹", "name": "ç©ºå¿ƒåœ“", "keywords": ["circle"] }
      ]
    }
  ]
}
```

---

### 3.2 Phase 2: å®Œæ•´ç‰ˆ

> **ç›®æ¨™**: åŠŸèƒ½å®Œæ•´ã€è·¨è£ç½®åŒæ­¥ã€å°ˆæ¥­ä½¿ç”¨è€…æ»¿æ„
> **å„ªå…ˆé †åº**: P1ï¼ˆé‡è¦åŠŸèƒ½ï¼‰

#### 3.2.1 æ”¶è—åŠŸèƒ½

**useFavorites.ts**
```typescript
import { useState, useEffect } from 'react';

export function useFavorites() {
  const [favorites, setFavorites] = useState<string[]>([]);

  useEffect(() => {
    // å¾ chrome.storage.sync è¼‰å…¥ï¼ˆè·¨è£ç½®åŒæ­¥ï¼‰
    chrome.storage.sync.get(['favorites'], (result) => {
      setFavorites(result.favorites || []);
    });

    // ç›£è½è®Šæ›´
    const listener = (changes: { [key: string]: chrome.storage.StorageChange }) => {
      if (changes.favorites) {
        setFavorites(changes.favorites.newValue || []);
      }
    };
    chrome.storage.onChanged.addListener(listener);
    return () => chrome.storage.onChanged.removeListener(listener);
  }, []);

  const toggleFavorite = async (symbol: string) => {
    const newFavorites = favorites.includes(symbol)
      ? favorites.filter(s => s !== symbol)
      : [...favorites, symbol];

    await chrome.storage.sync.set({ favorites: newFavorites });
    setFavorites(newFavorites);
  };

  const isFavorite = (symbol: string) => favorites.includes(symbol);

  return { favorites, toggleFavorite, isFavorite };
}
```

#### 3.2.2 é€²éšæœå°‹

```typescript
// shared/utils/search.ts

// æ‹¼éŸ³é¦–å­—æ¯æœå°‹æ”¯æ´
const pinyinMap: Record<string, string> = {
  'ç®­é ­': 'jt',
  'ç¬¦è™Ÿ': 'fh',
  'æ•¸å­¸': 'sx',
  'æ¨™é»': 'bd',
  // ... æ›´å¤šæ˜ å°„
};

export function searchSymbols(
  categories: SymbolCategory[],
  query: string
): SymbolCategory[] {
  if (!query.trim()) return categories;

  const lowerQuery = query.toLowerCase();

  return categories
    .map(cat => ({
      ...cat,
      symbols: cat.symbols.filter(s => {
        // ç¬¦è™Ÿæœ¬èº«åŒ¹é…
        if (s.symbol.includes(query)) return true;

        // åç¨±åŒ¹é…
        if (s.name.toLowerCase().includes(lowerQuery)) return true;

        // é—œéµå­—åŒ¹é…
        if (s.keywords?.some(k => k.toLowerCase().includes(lowerQuery))) return true;

        // æ‹¼éŸ³åŒ¹é…
        const pinyin = pinyinMap[s.name];
        if (pinyin && pinyin.includes(lowerQuery)) return true;

        return false;
      })
    }))
    .filter(cat => cat.symbols.length > 0);
}
```

#### 3.2.3 ä¸»é¡Œç³»çµ±

```typescript
// shared/hooks/useTheme.ts

type Theme = 'light' | 'dark' | 'system';

export function useTheme() {
  const [theme, setTheme] = useState<Theme>('system');

  useEffect(() => {
    chrome.storage.local.get(['settings'], (result) => {
      setTheme(result.settings?.theme || 'system');
    });
  }, []);

  useEffect(() => {
    const root = document.documentElement;

    if (theme === 'system') {
      const isDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      root.classList.toggle('dark', isDark);
    } else {
      root.classList.toggle('dark', theme === 'dark');
    }
  }, [theme]);

  const updateTheme = async (newTheme: Theme) => {
    const result = await chrome.storage.local.get(['settings']);
    await chrome.storage.local.set({
      settings: { ...result.settings, theme: newTheme }
    });
    setTheme(newTheme);
  };

  return { theme, setTheme: updateTheme };
}
```

#### 3.2.4 è¨­å®šé é¢

```tsx
// options/Options.tsx

import { useState, useEffect } from 'react';
import { useTheme } from '../shared/hooks/useTheme';

export function Options() {
  const { theme, setTheme } = useTheme();
  const [settings, setSettings] = useState({
    showCopyFeedback: true,
    maxRecentSymbols: 10,
    symbolSize: 'medium' as const
  });

  useEffect(() => {
    chrome.storage.local.get(['settings'], (result) => {
      if (result.settings) {
        setSettings(s => ({ ...s, ...result.settings }));
      }
    });
  }, []);

  const updateSetting = async <K extends keyof typeof settings>(
    key: K,
    value: typeof settings[K]
  ) => {
    const newSettings = { ...settings, [key]: value };
    setSettings(newSettings);
    await chrome.storage.local.set({ settings: newSettings });
  };

  return (
    <div className="max-w-xl mx-auto p-6 space-y-6">
      <h1 className="text-2xl font-bold">SmilePicker è¨­å®š</h1>

      {/* å¤–è§€è¨­å®š */}
      <section className="space-y-4">
        <h2 className="text-lg font-semibold">å¤–è§€</h2>

        <div className="flex items-center justify-between">
          <label>ä¸»é¡Œ</label>
          <select
            value={theme}
            onChange={(e) => setTheme(e.target.value as any)}
            className="px-3 py-2 border rounded-lg"
          >
            <option value="system">è·Ÿéš¨ç³»çµ±</option>
            <option value="light">æ·ºè‰²</option>
            <option value="dark">æ·±è‰²</option>
          </select>
        </div>

        <div className="flex items-center justify-between">
          <label>ç¬¦è™Ÿå¤§å°</label>
          <select
            value={settings.symbolSize}
            onChange={(e) => updateSetting('symbolSize', e.target.value as any)}
            className="px-3 py-2 border rounded-lg"
          >
            <option value="small">å°</option>
            <option value="medium">ä¸­</option>
            <option value="large">å¤§</option>
          </select>
        </div>
      </section>

      {/* è¡Œç‚ºè¨­å®š */}
      <section className="space-y-4">
        <h2 className="text-lg font-semibold">è¡Œç‚º</h2>

        <div className="flex items-center justify-between">
          <label>é¡¯ç¤ºè¤‡è£½æç¤º</label>
          <input
            type="checkbox"
            checked={settings.showCopyFeedback}
            onChange={(e) => updateSetting('showCopyFeedback', e.target.checked)}
            className="w-5 h-5"
          />
        </div>

        <div className="flex items-center justify-between">
          <label>æœ€è¿‘ä½¿ç”¨æ•¸é‡</label>
          <input
            type="number"
            min={3}
            max={20}
            value={settings.maxRecentSymbols}
            onChange={(e) => updateSetting('maxRecentSymbols', parseInt(e.target.value))}
            className="w-20 px-3 py-2 border rounded-lg"
          />
        </div>
      </section>

      {/* å¿«æ·éµèªªæ˜ */}
      <section className="space-y-4">
        <h2 className="text-lg font-semibold">å¿«æ·éµ</h2>
        <p className="text-gray-600">
          é è¨­å¿«æ·éµï¼š<kbd className="px-2 py-1 bg-gray-100 rounded">Alt + S</kbd>
        </p>
        <p className="text-sm text-gray-500">
          å¯åœ¨ Chrome è¨­å®š â†’ æ“´å……åŠŸèƒ½ â†’ éµç›¤å¿«æ·éµ ä¸­è‡ªè¨‚
        </p>
      </section>

      {/* é—œæ–¼ */}
      <section className="space-y-2 pt-4 border-t">
        <h2 className="text-lg font-semibold">é—œæ–¼</h2>
        <p className="text-gray-600">SmilePicker v1.0.0</p>
        <p className="text-sm text-gray-500">
          å¿«é€Ÿå­˜å–æ•¸åƒå€‹ç‰¹æ®Šç¬¦è™Ÿçš„ Chrome å´é‚Šé¢æ¿æ’ä»¶
        </p>
      </section>
    </div>
  );
}
```

#### 3.2.5 Onboarding æµç¨‹

é¦–æ¬¡å®‰è£æ™‚é¡¯ç¤ºæ­¡è¿é é¢ï¼š

```typescript
// background/service-worker.ts æ–°å¢

chrome.runtime.onInstalled.addListener(async (details) => {
  if (details.reason === 'install') {
    // é–‹å•Ÿæ­¡è¿é é¢
    await chrome.tabs.create({
      url: chrome.runtime.getURL('onboarding/index.html')
    });
  }
});
```

---

### 3.3 Phase 3: ç²¾é¸ç‰ˆ

> **ç›®æ¨™**: è¶…è¶Šé æœŸã€ç²å¾— Chrome Web Store ç²¾é¸æ¨è–¦
> **å„ªå…ˆé †åº**: P2ï¼ˆå·®ç•°åŒ–åŠŸèƒ½ï¼‰

#### 3.3.1 Glassmorphism UI

```css
/* æ¯›ç»ç’ƒæ•ˆæœ */
.glass-panel {
  background: rgba(255, 255, 255, 0.8);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.3);
}

.dark .glass-panel {
  background: rgba(30, 30, 30, 0.8);
  border: 1px solid rgba(255, 255, 255, 0.1);
}
```

#### 3.3.2 éµç›¤å°èˆª

```tsx
// å®Œæ•´éµç›¤å°èˆªæ”¯æ´
function useKeyboardNavigation(symbols: string[], onSelect: (s: string) => void) {
  const [focusIndex, setFocusIndex] = useState(-1);
  const columns = 7;

  useEffect(() => {
    const handleKeyDown = (e: KeyboardEvent) => {
      switch (e.key) {
        case 'ArrowRight':
          setFocusIndex(i => Math.min(i + 1, symbols.length - 1));
          break;
        case 'ArrowLeft':
          setFocusIndex(i => Math.max(i - 1, 0));
          break;
        case 'ArrowDown':
          setFocusIndex(i => Math.min(i + columns, symbols.length - 1));
          break;
        case 'ArrowUp':
          setFocusIndex(i => Math.max(i - columns, 0));
          break;
        case 'Enter':
        case ' ':
          if (focusIndex >= 0) {
            onSelect(symbols[focusIndex]);
          }
          break;
        case 'Escape':
          setFocusIndex(-1);
          break;
      }
    };

    window.addEventListener('keydown', handleKeyDown);
    return () => window.removeEventListener('keydown', handleKeyDown);
  }, [symbols, focusIndex, onSelect]);

  return { focusIndex, setFocusIndex };
}
```

#### 3.3.3 å³éµé¸å–®æ•´åˆ

```typescript
// åœ¨ç¶²é ä¸­é¸å–æ–‡å­—æ™‚ï¼Œå³éµé¸å–®åŠ å…¥ã€Œæ’å…¥ç¬¦è™Ÿã€é¸é …
chrome.contextMenus.create({
  id: 'insert-symbol',
  title: 'æ’å…¥ç¬¦è™Ÿ',
  contexts: ['editable']
});

chrome.contextMenus.onClicked.addListener(async (info, tab) => {
  if (info.menuItemId === 'insert-symbol' && tab?.id) {
    await chrome.sidePanel.open({ tabId: tab.id });
  }
});
```

#### 3.3.4 Content Script ç›´æ¥æ’å…¥

```typescript
// content/inject-symbol.ts
// ç›´æ¥å°‡ç¬¦è™Ÿæ’å…¥åˆ°ç•¶å‰æ¸¸æ¨™ä½ç½®

chrome.runtime.onMessage.addListener((message, sender, sendResponse) => {
  if (message.type === 'INSERT_SYMBOL') {
    const activeElement = document.activeElement as HTMLInputElement | HTMLTextAreaElement;

    if (activeElement && (activeElement.tagName === 'INPUT' || activeElement.tagName === 'TEXTAREA')) {
      const start = activeElement.selectionStart || 0;
      const end = activeElement.selectionEnd || 0;
      const value = activeElement.value;

      activeElement.value = value.substring(0, start) + message.symbol + value.substring(end);
      activeElement.selectionStart = activeElement.selectionEnd = start + message.symbol.length;

      // è§¸ç™¼ input äº‹ä»¶
      activeElement.dispatchEvent(new Event('input', { bubbles: true }));
    }

    sendResponse({ success: true });
  }
});
```

---

## 4. æŠ€è¡“æ¶æ§‹è¨­è¨ˆ

### 4.1 æŠ€è¡“å †ç–Š

| å±¤ç´š | æŠ€è¡“é¸æ“‡ |
|-----|---------|
| èªè¨€ | TypeScript 5.x |
| æ¡†æ¶ | React 18 |
| æ¨£å¼ | Tailwind CSS 3.x |
| æ‰“åŒ… | Vite + CRXJS |
| ç‹€æ…‹ç®¡ç† | React Hooks + Context |
| å„²å­˜ | chrome.storage API |
| Manifest | V3 |

### 4.2 å°ˆæ¡ˆåˆå§‹åŒ–æŒ‡ä»¤

```bash
# ä½¿ç”¨ Vite Chrome Extension æ¨¡æ¿
npm create vite@latest smilepicker-extension -- --template react-ts

cd smilepicker-extension

# å®‰è£ä¾è³´
npm install @crxjs/vite-plugin tailwindcss postcss autoprefixer clsx

# åˆå§‹åŒ– Tailwind
npx tailwindcss init -p
```

### 4.3 Vite é…ç½®

```typescript
// vite.config.ts
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';
import { crx } from '@crxjs/vite-plugin';
import manifest from './manifest.json';

export default defineConfig({
  plugins: [
    react(),
    crx({ manifest })
  ],
  build: {
    rollupOptions: {
      input: {
        sidepanel: 'src/sidepanel/index.html',
        options: 'src/options/index.html',
        onboarding: 'src/onboarding/index.html'
      }
    }
  }
});
```

### 4.4 è³‡æ–™æµæ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Side Panel UI                          â”‚
â”‚                    (React Components)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     React Hooks                             â”‚
â”‚  useSymbols / useFavorites / useStorage / useTheme          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Chrome Storage API                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  chrome.storage.local â”‚  chrome.storage.sync                â”‚
â”‚  - æœ€è¿‘ä½¿ç”¨            â”‚  - æ”¶è—ç¬¦è™Ÿ                         â”‚
â”‚  - æœ¬åœ°è¨­å®š            â”‚  - åŒæ­¥è¨­å®š                         â”‚
â”‚  - å¿«å–è³‡æ–™            â”‚                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. UI/UX è¨­è¨ˆè¦ç¯„

### 5.1 Side Panel å°ºå¯¸

| å±¬æ€§ | æ•¸å€¼ |
|-----|------|
| é è¨­å¯¬åº¦ | 320pxï¼ˆChrome æ§åˆ¶ï¼‰ |
| æœ€å°å¯¬åº¦ | 240px |
| æœ€å¤§å¯¬åº¦ | 500px |
| é«˜åº¦ | 100vhï¼ˆéš¨è¦–çª—é«˜åº¦ï¼‰ |

### 5.2 è¨­è¨ˆç³»çµ±

#### è‰²å½©ç³»çµ±ï¼ˆTailwindï¼‰

```javascript
// tailwind.config.js
module.exports = {
  darkMode: 'class',
  theme: {
    extend: {
      colors: {
        primary: {
          50: '#eff6ff',
          500: '#3b82f6',
          600: '#2563eb',
          700: '#1d4ed8'
        }
      }
    }
  }
}
```

#### å­—å‹ç³»çµ±

| ç”¨é€” | Tailwind é¡åˆ¥ |
|-----|--------------|
| æ¨™é¡Œ | `text-base font-semibold` |
| åˆ†é¡æ¨™é¡Œ | `text-sm font-medium` |
| ç¬¦è™Ÿ | `text-xl` |
| æ¨™ç±¤ | `text-xs` |

#### é–“è·ç³»çµ±

| åç¨± | Tailwind | æ•¸å€¼ |
|-----|----------|------|
| xs | `p-1` | 4px |
| sm | `p-2` | 8px |
| md | `p-3` | 12px |
| lg | `p-4` | 16px |
| xl | `p-6` | 24px |

### 5.3 å‹•ç•«è¦ç¯„

```css
/* Tailwind å‹•ç•«æ“´å±• */
@layer utilities {
  .animate-scale-in {
    animation: scale-in 0.15s ease-out;
  }

  .animate-fade-in {
    animation: fade-in 0.2s ease-out;
  }
}

@keyframes scale-in {
  from {
    transform: scale(0.95);
    opacity: 0;
  }
  to {
    transform: scale(1);
    opacity: 1;
  }
}

@keyframes fade-in {
  from { opacity: 0; }
  to { opacity: 1; }
}
```

### 5.4 éŸ¿æ‡‰å¼è¨­è¨ˆ

Side Panel å¯¬åº¦ç”±ä½¿ç”¨è€…æ‹–æ›³èª¿æ•´ï¼Œéœ€ç¢ºä¿ï¼š
- æœ€å° 240px æ™‚ä»å¯æ­£å¸¸ä½¿ç”¨
- ç¬¦è™Ÿç¶²æ ¼è‡ªå‹•èª¿æ•´æ¬„æ•¸
- æœå°‹æ¡†å¯¬åº¦ 100%

```tsx
// è‡ªé©æ‡‰ç¶²æ ¼
<div className="grid grid-cols-[repeat(auto-fill,minmax(40px,1fr))] gap-2">
  {symbols.map(s => <SymbolButton key={s.symbol} {...s} />)}
</div>
```

---

## 6. Chrome Web Store ä¸Šæ¶æº–å‚™

### 6.1 å¿…è¦è³‡ç”¢

#### åœ–ç¤ºå°ºå¯¸

| å°ºå¯¸ | ç”¨é€” |
|-----|------|
| 16x16 | å·¥å…·åˆ—ï¼ˆå°ï¼‰ |
| 32x32 | å·¥å…·åˆ—ï¼ˆæ¨™æº–ï¼‰ |
| 48x48 | æ“´å……åŠŸèƒ½ç®¡ç†é é¢ |
| 128x128 | Chrome Web Store |

#### å•†åº—æˆªåœ–

| å°ºå¯¸ | æ•¸é‡ | å…§å®¹å»ºè­° |
|-----|------|---------|
| 1280x800 æˆ– 640x400 | 5 å¼µ | ä¸»åŠŸèƒ½å±•ç¤º |

**æˆªåœ–æ¸…å–®**ï¼š
1. Side Panel å…¨è²Œï¼ˆå«æœ€è¿‘ä½¿ç”¨ã€åˆ†é¡ï¼‰
2. æœå°‹åŠŸèƒ½å±•ç¤º
3. æ”¶è—åŠŸèƒ½
4. è¨­å®šé é¢
5. æ·±è‰²æ¨¡å¼

#### å®£å‚³åœ–ç‰‡

| å°ºå¯¸ | ç”¨é€” |
|-----|------|
| 440x280 | å°å‹å®£å‚³ç£š |
| 1400x560 | å¤§å‹å®£å‚³æ©«å¹…ï¼ˆå¯é¸ï¼‰ |

### 6.2 å•†åº—æ–‡æ¡ˆ

#### æ“´å……åŠŸèƒ½åç¨±
```
SmilePicker - ç¬¦è™Ÿå¿«é¸
```

#### ç°¡çŸ­æè¿°ï¼ˆ132 å­—å…ƒå…§ï¼‰
```
Chrome å´é‚Šé¢æ¿ç¬¦è™Ÿå¿«é€Ÿè¼¸å…¥å·¥å…·ã€‚å¿«æ·éµä¸€è§¸å³é”ï¼Œæ™ºæ…§æœå°‹ã€æ”¶è—åŒæ­¥ã€æ·±è‰²æ¨¡å¼ã€‚
```

#### è©³ç´°æè¿°
```
SmilePicker æ˜¯ Chrome ä¸Šæœ€å„ªé›…çš„ç¬¦è™Ÿå¿«é€Ÿè¼¸å…¥å´é‚Šé¢æ¿æ’ä»¶ã€‚

â–  å³æ™‚å­˜å–
â€¢ å´é‚Šé¢æ¿è¨­è¨ˆï¼Œä¸é®æ“‹ç¶²é å…§å®¹
â€¢ å¿«æ·éµ Alt+S ä¸€è§¸å³é”ï¼ˆå¯è‡ªè¨‚ï¼‰
â€¢ ä¸€éµè¤‡è£½ï¼Œé«˜æ•ˆå·¥ä½œ

â–  æ™ºæ…§æœå°‹
â€¢ è¼¸å…¥åç¨±ã€é—œéµå­—æˆ–ç¬¦è™Ÿæœ¬èº«
â€¢ æ”¯æ´ä¸­è‹±æ–‡æœå°‹
â€¢ æœå°‹çµæœå³æ™‚é¡¯ç¤º

â–  å€‹äººåŒ–
â€¢ ç¬¦è™Ÿæ”¶è—åŠŸèƒ½
â€¢ Chrome å¸³è™ŸåŒæ­¥
â€¢ æ·ºè‰²/æ·±è‰²ä¸»é¡Œåˆ‡æ›

â–  è±å¯Œç¬¦è™Ÿåº«
â€¢ ç®­é ­ç¬¦è™Ÿï¼šâ†’ â† â†‘ â†“ â‡’
â€¢ æ•¸å­¸ç¬¦è™Ÿï¼šÂ± Ã— Ã· â‰  âˆ
â€¢ æ¨™é»ç¬¦è™Ÿï¼šã€Œã€ã€ã€ã€ã€‘
â€¢ éµç›¤ç¬¦è™Ÿï¼šâŒ˜ âŒ¥ â‡§ âŒƒ
â€¢ è²¨å¹£ç¬¦è™Ÿï¼šÂ¥ â‚¬ Â£ â‚¿
â€¢ è£é£¾ç¬¦è™Ÿï¼šâ˜… â™¥ â— â—‹

ç«‹å³å®‰è£ SmilePickerï¼Œè®“ç¬¦è™Ÿè¼¸å…¥æˆç‚ºæ„‰æ‚…çš„é«”é©—ï¼
```

### 6.3 æ¬Šé™èªªæ˜

åœ¨ä¸Šæ¶å¯©æ ¸æ™‚éœ€èªªæ˜å„æ¬Šé™ç”¨é€”ï¼š

| æ¬Šé™ | ç”¨é€”èªªæ˜ |
|-----|---------|
| `sidePanel` | é¡¯ç¤ºå´é‚Šé¢æ¿ä»‹é¢ |
| `storage` | å„²å­˜ä½¿ç”¨è€…è¨­å®šã€æ”¶è—å’Œæœ€è¿‘ä½¿ç”¨è¨˜éŒ„ |
| `clipboardWrite` | å°‡ç¬¦è™Ÿè¤‡è£½åˆ°å‰ªè²¼ç°¿ |

### 6.4 éš±ç§æ”¿ç­–è¦é»

```
SmilePicker éš±ç§æ”¿ç­–

è³‡æ–™æ”¶é›†ï¼š
- æœ¬æ“´å……åŠŸèƒ½ä¸æ”¶é›†ä»»ä½•å€‹äººè­˜åˆ¥è³‡è¨Š
- ä½¿ç”¨è¨˜éŒ„åƒ…å„²å­˜æ–¼æœ¬æ©Ÿï¼ˆchrome.storage.localï¼‰
- æ”¶è—ç¬¦è™Ÿé€é Chrome å¸³è™ŸåŒæ­¥ï¼ˆchrome.storage.syncï¼‰ï¼Œç”± Google ç®¡ç†
- ç„¡ä»»ä½•ç¬¬ä¸‰æ–¹åˆ†ææˆ–è¿½è¹¤å·¥å…·

è³‡æ–™ä½¿ç”¨ï¼š
- æ‰€æœ‰è³‡æ–™åƒ…ç”¨æ–¼æä¾›æ“´å……åŠŸèƒ½æœå‹™
- ä¸æœƒèˆ‡ä»»ä½•ç¬¬ä¸‰æ–¹åˆ†äº«è³‡æ–™
```

---

## 7. é–‹ç™¼æ™‚ç¨‹å»ºè­°

### 7.1 é‡Œç¨‹ç¢‘æ¦‚è¦½

```
Phase 1: MVP æ ¸å¿ƒç‰ˆ
â”œâ”€â”€ å°ˆæ¡ˆåˆå§‹åŒ–ï¼ˆVite + React + Tailwindï¼‰
â”œâ”€â”€ Manifest V3 é…ç½®
â”œâ”€â”€ Side Panel åŸºç¤ UI
â”œâ”€â”€ ç¬¦è™Ÿè³‡æ–™èˆ‡æœå°‹
â”œâ”€â”€ è¤‡è£½åŠŸèƒ½
â”œâ”€â”€ æœ€è¿‘ä½¿ç”¨è¿½è¹¤
â””â”€â”€ åŸºç¤æ¨£å¼ï¼ˆæ·ºè‰²/æ·±è‰²ï¼‰

Phase 2: å®Œæ•´ç‰ˆ
â”œâ”€â”€ æ”¶è—åŠŸèƒ½ + åŒæ­¥
â”œâ”€â”€ è¨­å®šé é¢
â”œâ”€â”€ é€²éšæœå°‹
â”œâ”€â”€ Onboarding æµç¨‹
â””â”€â”€ å®Œæ•´ä¸»é¡Œç³»çµ±

Phase 3: ç²¾é¸ç‰ˆ
â”œâ”€â”€ Glassmorphism UI
â”œâ”€â”€ éµç›¤å°èˆª
â”œâ”€â”€ å³éµé¸å–®æ•´åˆ
â”œâ”€â”€ Content Script ç›´æ¥æ’å…¥
â””â”€â”€ æ•ˆèƒ½å„ªåŒ–
```

### 7.2 é–‹ç™¼æŒ‡ä»¤

```bash
# é–‹ç™¼æ¨¡å¼ï¼ˆç†±é‡è¼‰ï¼‰
npm run dev

# å»ºç½®ç”Ÿç”¢ç‰ˆæœ¬
npm run build

# è¼‰å…¥æ“´å……åŠŸèƒ½
# 1. é–‹å•Ÿ chrome://extensions/
# 2. å•Ÿç”¨ã€Œé–‹ç™¼äººå“¡æ¨¡å¼ã€
# 3. é»æ“Šã€Œè¼‰å…¥æœªå°è£é …ç›®ã€
# 4. é¸æ“‡ dist/ è³‡æ–™å¤¾
```

---

## é™„éŒ„ï¼šå¯¦ç”¨ç¨‹å¼ç¢¼ç‰‡æ®µ

### A. Clipboard API å°è£

```typescript
// shared/utils/clipboard.ts

export async function copyToClipboard(text: string): Promise<boolean> {
  try {
    await navigator.clipboard.writeText(text);
    return true;
  } catch (err) {
    // Fallback for older browsers
    const textarea = document.createElement('textarea');
    textarea.value = text;
    textarea.style.position = 'fixed';
    textarea.style.opacity = '0';
    document.body.appendChild(textarea);
    textarea.select();

    try {
      document.execCommand('copy');
      return true;
    } catch {
      return false;
    } finally {
      document.body.removeChild(textarea);
    }
  }
}
```

### B. Storage Hook

```typescript
// shared/hooks/useStorage.ts

import { useState, useEffect } from 'react';

export function useStorage<T>(key: string, defaultValue: T) {
  const [value, setValue] = useState<T>(defaultValue);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    chrome.storage.local.get([key], (result) => {
      if (result[key] !== undefined) {
        setValue(result[key]);
      }
      setLoading(false);
    });

    const listener = (changes: { [key: string]: chrome.storage.StorageChange }) => {
      if (changes[key]) {
        setValue(changes[key].newValue);
      }
    };

    chrome.storage.onChanged.addListener(listener);
    return () => chrome.storage.onChanged.removeListener(listener);
  }, [key]);

  const setStorageValue = async (newValue: T) => {
    await chrome.storage.local.set({ [key]: newValue });
    setValue(newValue);
  };

  return { value, setValue: setStorageValue, loading };
}
```

### C. ç¬¦è™Ÿ Unicode è³‡è¨Šé¡¯ç¤º

```typescript
// å–å¾—ç¬¦è™Ÿçš„ Unicode ç·¨ç¢¼
export function getUnicodeInfo(symbol: string): string {
  return [...symbol]
    .map(char => `U+${char.codePointAt(0)?.toString(16).toUpperCase().padStart(4, '0')}`)
    .join(' ');
}

// "â†’".getUnicodeInfo() â†’ "U+2192"
```

---

## çµèª

æœ¬ PRD è¦åŠƒäº† SmilePicker å¾ MVP åˆ° Chrome Web Store ç²¾é¸æ¨è–¦çš„å®Œæ•´ç™¼å±•è·¯å¾‘ã€‚é€éä¸‰å€‹éšæ®µçš„è¿­ä»£é–‹ç™¼ï¼Œé€æ­¥æå‡ç”¢å“å“è³ªèˆ‡åŠŸèƒ½æ·±åº¦ã€‚

**æ ¸å¿ƒåŸå‰‡**ï¼š
1. **ä½¿ç”¨è€…é«”é©—å„ªå…ˆ** - å´é‚Šé¢æ¿ä¸é®æ“‹ç¶²é ï¼Œæ“ä½œæµæš¢
2. **æ¼¸é€²å¼é–‹ç™¼** - æ¯å€‹ Phase éƒ½æ˜¯å¯ç™¼å¸ƒçš„ç©©å®šç‰ˆæœ¬
3. **åŸç”Ÿé«”é©—** - éµå¾ª Chrome Extension è¨­è¨ˆè¦ç¯„

**ä¸‹ä¸€æ­¥è¡Œå‹•**ï¼š
1. ç¢ºèª Phase 1 åŠŸèƒ½ç¯„åœèˆ‡å„ªå…ˆé †åº
2. å»ºç«‹å°ˆæ¡ˆçµæ§‹
3. é–‹å§‹ Manifest V3 é…ç½®èˆ‡åŸºç¤ UI é–‹ç™¼
